
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Craig Marvelley</title>
  <meta name="author" content="Craig Marvelley">

  
  <meta name="description" content="Over the last couple of weeks I&#8217;ve been involved in a new initiative at Box UK to package and release some of our code under an open source &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://marvelley.com/blog/page/4">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Craig Marvelley" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-1845487-3']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Craig Marvelley</a></h1>
  
    <h2>Software and such</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:marvelley.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/12/06/box-uk-open-source-software-and-php/">Box UK, Open Source Software and PHP</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-12-06T00:00:00+00:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Over the last couple of weeks I&#8217;ve been involved in a new initiative at <a href="http://boxuk.com">Box UK</a> to <a href="http://www.boxuk.com/news/announcing-box-uk-open-source-software-libraries">package and release some of our code under an open source license</a>. This decision stemmed from some conversations I had with fellow developers at the PHPNW 2010 conference,  specifically relating to dependency injection and how it can be useful in larger PHP applications. People seemed interested in the DI container solution developed for <a href="http://amaxus.com">Amaxus</a> using features introduced to PHP in the 5.3 release, so we decided to make both that and a thumbnailing library available to the wider community in the hope that they may prove useful.</p>

<p>More can be read about boxuk-di, the dependency injection library, <a href="http://www.boxuk.com/labs/dependency-injection-and-reflection-library">on this page</a>. The article outlines some of the nifty features of the library, such as using reflection to achieve automatic dependency resolution, doing away with the configuration files commonly found in DI solutions. The <a href="http://github.com/boxuk/boxuk-di">code</a> itself is available at <a href="http://github.com/boxuk">BoxUK&#8217;s github</a> page. It&#8217;s pretty cool, and makes creating objects with loads of dependencies a breeze.</p>

<p>The second library, Obscura, is a wrapper for <a href="http://php.net/gd">PHP&#8217;s GD library</a> that aims to make it easy to do image thumbnailing using an object oriented approach. I wrote the library earlier in the year, and it&#8217;s currently used in the Amaxus CMS. It&#8217;s still in its infancy, and there&#8217;s plenty I hope to add to it in the near future (like cropping and watermarking) but as a simple thumbnailer it does the job. I don&#8217;t know of too many thumbnailers for PHP with such a permissive license, which was the driving force behind my desire to write this one. More details can be found at <a href="http://www.boxuk.com/labs/obscura,-the-php-thumbnail-library">Box UK&#8217;s website</a>, while again the <a href="http://github.com/boxuk/obscura">code</a> can be found at the <a href="http://github.com/boxuk">company&#8217;s github repository</a>.</p>

<p>Hopefully there&#8217;ll be more to come if these initial releases prove successful. I&#8217;m glad to have been involved in the project, as it&#8217;s helped alleviate some of my guilt at using so many excellent open source tools but, until now, not giving anything back. I&#8217;m aiming to release some of my own code in a similar fashion in the near future.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/11/28/titanium-appcelerator-resizing-the-andriod-emulator/">Titanium Appcelerator &#8211; Resizing the Andriod Emulator</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-11-28T00:00:00+00:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>While messing around with Appcelerator it was annoying that on my 13&#8243; Macbook the Android emulator was too big for the screen &#8211; the Titanium Developer program doesn&#8217;t provide a way to change this. My workaround was to copy the command that&#8217;s being run to launch the emulator from the console output, and run the emulator manually with a resize option before deploying the app.</p>

<p>This can be accomplished using the emulator&#8217;s -scale option, which is a number from 0.1 to 3. I found setting it to 0.7 resulted in an emulator with a workable size for my Macbook.</p>

<p>From the root of your Android SDK folder run:</p>

<p>/tools/emulator -avd titanium_2_WVGA854 -port 5560 -sdcard ~/.titanium/android2.sdcard -logcat &#8216;*:d *&#8217; -no-boot-anim -partition-size 128 -scale 0.7</p>

<p>(titanium_2_WVGA854 is the name of the emulator created by Titanium, this will differ depending on your chosen emulator).</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/11/05/jelly-form-element-references-for-hudson-development/">Jelly Form Element References for Hudson Development</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-11-05T00:00:00+00:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&#8217;ve been working on a Hudson plugin, which has been interesting because it&#8217;s been years since I&#8217;ve done any Java development. The tag library used by Hudson, Jelly, seems powerful enough but it&#8217;s not immediately apparent what tags it supports, and the Hudson documentation doesn&#8217;t go into much detail. The only two resources I could find are:</p>

<p>A tag reference (think this is generated from the Jelly JavaDoc)<br/>
<a href="http://hudson-ci.org/maven-site/hudson-core/jelly-taglib-ref.html">http://hudson-ci.org/maven-site/hudson-core/jelly-taglib-ref.html</a></p>

<p>Browse the source<br/>
<a href="https://hudson.dev.java.net/source/browse/hudson/trunk/hudson/main/core/src/main/resources/lib/form/">https://hudson.dev.java.net/source/browse/hudson/trunk/hudson/main/core/src/main/resources/lib/form/</a></p>

<p>Though I picked up the most knowledge from checking out the Hudson source and just looking through the many plugins that have been added to the project &#8211; there are plenty of real-world examples of how to implement various UI patterns.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/10/13/magento-on-windows-unable-to-log-into-admin-area/">Magento on Windows: Unable to Log Into Admin Area</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-10-13T00:00:00+00:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&#8217;ve run into this issue a few times when setting <a href="http://www.magentocommerce.com/">Magento</a> up on Windows, but keep forgetting how to resolve it. After the setup wizard, on attempting to log into the admin area with the correct credentials I was constantly being redirected back to the login screen with no errors to suggest why I&#8217;d been denied.</p>

<p>There&#8217;s <a href="http://www.magentocommerce.com/boards/viewthread/43148/">some advice</a> on the Magento forum that advocates commenting out some code relating to session cookie instantiation, but the fault seems to lie with Magento requiring a <a href="http://en.wikipedia.org/wiki/Top-level_domain">TLD</a> in order to persist the session &#8211; therefore placing your installation at a URL like <a href="http://magento.something">http://magento.something</a> rather than <a href="http://magento">http://magento</a> should prevent this happening and let you access the store backend without having to hack modify the code.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/10/13/dompdf-and-the-mbstring-extension/">DOMPDF and the Mbstring Extension</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-10-13T00:00:00+00:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&#8217;ve been using <a href="http://www.digitaljunkies.ca/dompdf/">DOMPDF</a> for a while &#8211; it&#8217;s a great tool for converting HTML to PDF through PHP. I&#8217;ve been running it locally on several machines without issue, but I recently deployed it to a server running Centos 5.5 and was greeted with a blank page with no output every time I tried to generate a file. No errors on screen, no errors in the log file &#8211; and no way to step through the code.</p>

<p>After a painful couple of hours of old-school echo()-ing I noticed a call to one of the mb_* functions &#8211; PHP&#8217;s set of functions for dealing with <a href="http://uk.php.net/mb_string">multibyte strings</a>. I don&#8217;t use that extension in my application, and DOMPDF doesn&#8217;t mention it in its installation notes along with its other dependencies, so I hadn&#8217;t thought I&#8217;d need it. A quick configure / make later though, and with the mbstring extension enabled PDFs were rendering quite happily.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/10/06/overcoming-a-lock-wait-timeout-exceeded-exception/">Overcoming a &#8216;lock Wait Timeout Exceeded&#8217; Exception.</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-10-06T00:00:00+00:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This exception was being thrown by <a href="http://doctrine-project.org">Doctrine</a> during a long-running process:</p>

<p><code>exception 'Doctrine_Connection_Mysql_Exception' with message 'SQLSTATE[HY000]: General error: 1205 Lock wait timeout exceeded; try restarting transaction'&lt;br /&gt;
</code></p>

<p>The code in question was performing a lot of queries within a transaction &#8211; it seems that innodb will only hold a lock for so long, and this limit was being reached before the transaction could commit and release the lock. The solution (other than refactoring the code to be a little quicker!) was to increase innodb&#8217;s <code>innodb_lock_wait_timeout</code> setting in <code>my.cnf</code> to accommodate the transaction.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/10/01/mount-alpha-transparent-images-php-gd/">Mounting Alpha Transparent Images With PHP and GD</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-10-01T00:00:00+00:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Yesterday brought a bug in a PHP thumbnail library I&#8217;ve been working on: when mounting a 24 bit PNG with alpha transparency onto another &#8216;framing&#8217; image the transparency was being lost. A simplified version of the code looks something like this:</p>

<pre>// Read the transparent image
$image = imagecreatefrompng('transparent.png');
$width = imagesx($image);
$height = imagesy($image);

// Create the mount
$border = 10;
$mountWidth = $width + ($border * 2);
$mountHeight = $height + ($border * 2);
$mount = imagecreatetruecolor($mountWidth, $mountHeight);
$mountColour = imagecolorallocate($mount, 255, 0, 0);
imagefilledrectangle($mount, 0, 0, $mountWidth, $mountHeight, $mountColour);

// Centre the image within the mount
imagecopymerge($mount, $image, $border, $border, 0, 0, $width, $height, 100);

// Output to screen
header('Content-Type: image/png');
imagepng($mount);</pre>


<p>This all worked well enough until someone tried mounting a PNG with alpha transparency, whereupon things became very messy. A bit of googling <a href="http://drupal.org/node/80369">suggested</a> <a href="http://www.phpfreaks.com/forums/index.php?topic=127046.0">that</a> that the <a href="http://uk.php.net/imagecopymerge">imagecopymerge</a>() function was to blame (I&#8217;d used  it because it allowed the manipulation of opacity in the merged image) and that the <a href="http://uk.php.net/imagecopy">imagecopy</a>() function handled transparency better &#8211; which I found to be the case.</p>

<p>So a transparency-friendly version of the script looks like:</p>

<pre>// Read the transparent image
$image = imagecreatefrompng('transparent.png');

...

// Centre the image within the mount
imagecopy($mount, $image, $border, $border, 0, 0, $width, $height);

// Output to screen
header('Content-Type: image/png');
imagepng($mount);</pre>


<p>And problem solved &#8211; though I&#8217;d like to find a way to maintain image transparency while also being able to adjust the opacity of the mounted image.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/09/23/much-success/">Much Success!</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-09-23T00:00:00+00:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&#8217;ve put off starting a blog for a while now. For good reason, it seems &#8211; getting this thing working was as hellish as I&#8217;d imagined! Hopefully the last few nights of fevered configuring and installing will be worth the effort.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/3/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/03/24/local-provisioning-with-ansible/">Local Provisioning With Ansible</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/18/vagrant-1-dot-5-syncing-situation/">Vagrant 1.5 Syncing Situation</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/06/goodbye-box-uk-hello-bipsync/">Goodbye Box UK, Hello BipSync</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/02/17/restore-missing-audio-in-imovie-for-mac/">Restore Missing Audio in iMovie for Mac</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/02/14/understanding-dns/">Understanding DNS</a>
      </li>
    
  </ul>
</section>



<section class="googleplus googleplus-hidden">
  <h1>
    <a href="https://plus.google.com/113573941679447813594?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Craig Marvelley -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'craigmarvelley';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
