<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Craig Marvelley]]></title>
  <link href="http://marvelley.com/atom.xml" rel="self"/>
  <link href="http://marvelley.com/"/>
  <updated>2014-10-17T09:18:38+00:00</updated>
  <id>http://marvelley.com/</id>
  <author>
    <name><![CDATA[Craig Marvelley]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[The Story of the Swn Festival iOS App]]></title>
    <link href="http://marvelley.com/blog/2014/10/17/the-story-of-the-swn-festival-ios-app/"/>
    <updated>2014-10-17T09:06:52+00:00</updated>
    <id>http://marvelley.com/blog/2014/10/17/the-story-of-the-swn-festival-ios-app</id>
    <content type="html"><![CDATA[<p>[This is a rambling post about iOS app development, third party abstractions like Appcelerator Titanium, dealing with short deadlines, evolving feature sets, submitting to the App Store, APIs with Symfony2, and more. I should have written a series of posts but I know I’d never have finished them, so this is a stream of consciousness affair that is hopefully understandable and of interest to someone)].</p>

<p>For the last four years I&rsquo;ve made an iPhone app for Cardiff&rsquo;s brilliant <a href="http://swnfest.com/">Swn Festival</a>. Each year I&rsquo;ve intended to write about the experience; this year I finally managed it.</p>

<p>That I have done so now is due to this year being the first to take advantage of groundwork gradually laid down since 2010, when I first approached <a href="https://twitter.com/john_rostron">John Rostron</a> with a horrendous prototype that I&rsquo;d made with <a href="http://www.appcelerator.com/titanium/">Appcelerator Titanium</a> while holidaying in Morocco (I&rsquo;m not sure what made the prototype quite so poor; the tools I was using, or the local beer I was drinking). John, one of the co-founders of the festival, thankfully saw past that early effort and gave his blessing for an official app, and there the hard work began.</p>

<p><img src="http://marvelley.com/images/posts/2014/10/swn_schedule.png" alt="image" /></p>

<p>In many ways this year&rsquo;s release is closer to a 1.0 than it is a 4.0, in terms of it having features I would have liked in from the get-go. In others, it&rsquo;s a step back; it actually has less functionality now than it did at the start. Here&rsquo;s the story of the app, right from the beginning.</p>

<h2>Version 1.0 - All kitchen, no sync</h2>

<p>Ideas for the app started to take shape a year prior, when I attended the festival in 2009. The event encompasses hundreds of bands playing in venues all over the city, typically over four days, and I was frustrated by constantly having to check the website to see who was playing where; the physical programme being difficult to read in the low-lit venues. I decided to build a simple app to display the schedule, and allow me to put together a personal plan of the bands I wanted to see, in time for the following year&rsquo;s event. I was keen on doing more iOS development and it seemed a good excuse as any. I accosted <a href="https://twitter.com/huwstephens">Huw Stephens</a>, who co-hosts the festival with John, during the closing night; he may not have been able to hear (or possibly understand) a single word I said but after I explained my plan he didn&rsquo;t say no, which was good enough for me.</p>

<p>The idea gestated over the next 9 months, until I began the prototype in late July 2010. I used Titanium, a cross platform mobile framework which lets you create apps using JavaScript, because I&rsquo;d done a few projects with it around the same time and I was fairly productive with it. I was yet to feel wholly comfortable with Objective-C, Apple&rsquo;s then advocated language for native iOS apps. I decided to implement the following features:</p>

<ul>
<li>An easily browsable schedule</li>
<li>A personalised shortlist of acts to see</li>
<li>An index of artists, with biographies, social media links etc. to aid discoverability</li>
<li>An index of venues</li>
</ul>


<p>That made up the prototype that I showed John that year, albeit with data from the previous year. Also in the meeting was <a href="https://twitter.com/iammarcthomas">Marc Thomas</a> who produces the Swn website along with lots of other things, and has therefore been closely involved with the app too. John asked if we could incorporate festival news and sponsor details into the app as well, which wasn&rsquo;t a problem.</p>

<p>Soon thereafter I decided to abandon Titanium and throw my lot in with Objective-C, reasons being:</p>

<ul>
<li>The Titanium IDE, based on Eclipse, was dreadful. XCode, Apple&rsquo;s IDE, isn&rsquo;t perfect but it was a sure improvement</li>
<li>I came across significant bugs with the platform, and when I submitted pull requests they sometimes went ignored for months</li>
<li>I needed to learn a lot about iOS very quickly, and didn&rsquo;t want to have to filter the knowledge I was getting from Apple documentation and other sources into a &ldquo;Titanium transformer&rdquo; so I could apply it on that platform</li>
</ul>


<p>I don&rsquo;t regret investing time in Titanium because it distills the common concepts of mobile development to the bare minimum. I found it very accessible, where native development can initially be daunting. Had I stuck with it there would probably be an Android version of the Swn app by now; these days I haven&rsquo;t the time to learn Android development, and was put off back then by its relative immaturity to iOS. Ultimately, once I was oriented I quickly outgrew the platform, and considering how much more complicated iOS has become since (see storyboards, auto layout, etc.) I wouldn’t want to stray too far from Apple’s toolchain - they struggle to keep up with it themselves.</p>

<p>It didn’t take very long to get the features I had in the prototype properly implemented in the native app, and the basic structure of the app hasn’t changed to this day. A tab bar controller hosted a navigation group for each distinct area of the app (schedule, artists, venues, and then also news and sponsors), and each of the sections made extensive use of tableviews to present data. I decided not to host the app’s data on a web service, and instead painstakingly added it manually to a set of plist files stored in the app bundle - this I would soon regret.</p>

<p>Another factor in deciding to go native was that a lot of the artists playing at the festival had <a href="https://soundcloud.com/">SoundCloud</a> accounts, and back then SoundCloud had a very permissive Objective-C client that made it ridiculously easy to stream songs via the app. As long as I attributed SoundCloud by displaying their logo I was free to play as much music as I wanted, so I added a player with some really basic playlist functionality as well. It was by far the most technically difficult part of the app (although all the clever bits around streaming were the SoundCloud library&rsquo;s doing) but I don&rsquo;t think many people even knew it was there. Indeed, my first submission to the App Store was rejected because the review team didn’t notice it and flagged the app as “unnecessarily requesting permission to play background audio&#8221; - which is a pretty damning indictment of my UX skills.</p>

<p>(Another late feature I added was the ability for users to share their personal planner on Facebook - I wrote a custom Facebook app, added authentication to the Swn app, integrated with their iOS SDK… and around six people ended up using it).</p>

<p>It was a rush to get the app ready in time. Because I was bundling the data in with the app, I had to wait until the schedule was finalised before I could ship; and before I could ship I had to pass Apple&rsquo;s app review process, which usually takes anywhere from a week to a fortnight. When I got the schedule with around a week to go before the festival started, I knew I was in trouble.</p>

<p>I submitted the app on the 14th October, three days before opening day, and knew that it wasn&rsquo;t going to make it in time. Desperate not to see our work go to waste, I frantically Googled for options - I briefly explored ways to distribute the app manually, which would have been insane - before reading about Apple&rsquo;s expedited review provision; this is a mechanism where app developers can request a shorter review time if they feel their submission meets certain criteria (like a critical bug fix, or - hallelujah - apps that are time dependent). I made the request and was extremely grateful when Apple granted it.</p>

<p>The app went live a day before the festival began.</p>

<p>Overall it was well received. There were the inevitable complaints that there wasn&rsquo;t a companion Android version, and each year since I&rsquo;ve intended to address that, only for a lack of time to prevent me doing do. Aside from that there was a single major problem.</p>

<p>A day into the festival I got an email from John asking if I could make a few amendments to the schedule; a few bands had dropped out, there had been a couple of set time alterations, etc. I hadn&rsquo;t considered this scenario at all, and here&rsquo;s where my decision to bundle the data with the app came back to bite me - any amendment to the schedule would require a new release and another trip through the review process. In my experience minor updates to existing apps do get approved quicker than brand new submissions (perhaps subsequent reviews are less stringent? Or are tasked to the same reviewer as before, so they’re familiar with the app?), but given the festival was only four days long, it was unlikely to be available in time to be of any use - and indeed the event was over halfway through before the update hit the App Store.</p>

<p>In retrospect it would have been wiser to have spent time on externalising the data rather than adding flashy but little used features. Thankfully user feedback and download statistics suggested that the app was popular, so I suppose it was a success nonetheless.</p>

<h2>Version 2.0 - Enter Wordpress</h2>

<p>When the time came to start thinking about an update for 2012&rsquo;s event an API was at the top of the list of new features. With an API delivering the schedule, artist and venue data the app could be updated at any time, without an app resubmission.</p>

<p>Since all of the artist data was already in the Wordpress installation that powered the Swn website it seemed logical to export it from there. Marc suggested we use the <a href="https://wordpress.org/plugins/jetpack/">JetPack plugin</a> for Wordpress to expose the artist data via its JSON API, and use the custom field functionality to provide additional data like set times or venue locations that were outside the requirements of the website. Inputting the data was a long-winded process, especially when adding dates since the custom field UI had no date picker - typing around 400 dates in ISO 8601 format into a text field is no fun. Thanks to <a href="https://twitter.com/morgapplegarth">Morgan</a>&rsquo;s hard work we eventually had an API delivering the data we needed - now I had to get it into the app.</p>

<p>The <a href="http://restkit.org/">RestKit</a> library for iOS hadn&rsquo;t been around long but looked like it would do exactly what I needed - make HTTP requests to given endpoints, transform the responses into objects using custom mappings, and then store the resulting object graph into Core Data, Apple&rsquo;s persistence framework. It also made it easy to load a seed database on the first run of the app, so I could bundle as accurate a dataset as I could get without leaving it too late to pass app review. That way the app would be fairly accurate from launch, and any amendments could be performed via the API as necessary. I had to jump through some hoops when transforming the object graph as our use of custom fields meant there weren&rsquo;t concrete objects with primary keys to map to my event and venue Core Data entities, but it didn&rsquo;t take long to work around that. I faked an identifier from hashed content to identify individual artist appearances, so I could persist favourited events beyond each schedule reload.</p>

<p>I found RestKit to be straightforward to implement, although its documentation was light, disorganised and outdated. Thankfully since getting it working I&rsquo;ve not needed to touch it in two years save to update the odd URL, which has been a relief. I&rsquo;ve often thought to replace it but if ain&rsquo;t broke&hellip;</p>

<p>I simplified the app by removing its Facebook integration; I doubt it was missed. The SoundCloud player survived, but I had to redesign it, and other parts of the app, to accommodate the iPhone 5 which was released in the September and introduced a new 4&#8221; screen size into the iPhone lineup. Since the app made use of lots of UITableViewControllers I was quite lucky in this regard - the tableviews naturally stretched a little more to take up the additional space.</p>

<p>Despite our improved data approach we still contrived to cut it close with the app submission. Thankfully it was approved in time, and I saw plenty of people using it during the festival. Since I&rsquo;m predominately a web developer I don&rsquo;t often get to see people use the things I make, so it was nice to observe the odd person browsing the schedule or reading about an artist.</p>

<h2>Version 3.0 - Bittersweet Symfony</h2>

<p>2013 continued the pattern of very little innovation from the app&rsquo;s perspective, with most of the work going into supporting the latest version of iOS (the 7th iteration came out that year and embraced flat design, so I gave the app a facelift to match) and improving data delivery.</p>

<p>Wordpress had proved a decent stop-gap API, but it needed to be replaced; it was too easy to enter incorrect data with no validation on custom fields, and the response times from the API were poor, and for a relatively small dataset too. Since people would usually be downloading over a data connection (3G at best) with spotty connectivity due to being in and out of venues I wanted updates to the schedule to be much quicker than they currently were.</p>

<p>I was working a lot with <a href="http://symfony.com/">Symfony2</a> at the time, and it&rsquo;s still my go-to PHP framework. Its out-of-the-box integration with the <a href="http://www.doctrine-project.org/">Doctrine ORM</a> means it&rsquo;s really easy to produce a decent webservice, so I decided to write my own API and import whatever I could from Wordpress to minimise he amount of data entry I had to do. Ideally the import would be semi-idempotent as well, so if any artist data (like biographies) changed I&rsquo;d be able to rerun the import to get the latest data but maintain existing identifiers, so as not to break user&rsquo;s favourite lists.</p>

<p>I used the <a href="http://sonata-project.org/bundles/admin/2-3/doc/index.html">Sonata Admin Bundle</a> for Symfony2 to provide a front end to the API, so the Swn team could update the schedule themselves and no longer rely on me. We also managed to get a new feature into the app - venue capacity indicators, so festival goers would know ahead of time if they were likely to be queuing to get in to see a particular artist.</p>

<p>Because the changes weren&rsquo;t drastic I didn&rsquo;t expect many side effects in the app, but man was I wrong. There were some nasty schedule issues to resolve (mostly around dates and time zones, which may have been in the app from the start but were surely highlighted by my API changes). As a result I once again ended up rushing to finish in time, and most maddeningly had to spend a day at the <a href="http://conference.phpnw.org.uk/phpnw13/">PHPNW13</a> conference ensconced in my room, coding frantically and missing talks. <a href="https://twitter.com/theSteveHalford">Steve Halford</a> - friend, colleague and beta tester extraordinaire - was probably sick of the sight of emails from <a href="https://www.testflightapp.com/">TestFlight</a> announcing another build for him to try. Another expedited review was requested, and granted. I&rsquo;ve read that developers are limited to a certain amount of these, so really it&rsquo;s a good thing I make apps sporadically.</p>

<h2>Version 4.0 - Auto layout aside…</h2>

<p>And so to 2014. I’ve been really busy since changing jobs last March, and feared I wouldn’t have time to produce the app this year. I was all set to take a back seat (which would have saddened me because I love making it and being involved) when I found out that this year’s festival was to be a smaller affair, and so if I were to do the app less work would be required. That was too tempting an offer to pass up, especially as I felt we’d spent four years getting to this point - where the API and the app were in harmony, and any time spent would be on maintaining the app and hopefully expanding it with the odd new feature.</p>

<p><img src="http://marvelley.com/images/posts/2014/10/swn_storyboard.png" alt="image" /></p>

<p>Of course, nothing’s ever that simple. Apple announced not one but two new devices this year, the iPhones 6 and 6 Plus, each with a screen size which meant the app needed to support four form factors in total (the 4s, 5/5s/5c, 6 and 6+). Up until now I’d been quite lucky, with each new release of iOS not needing much in the way of view changes, but after watching several of this year’s WWDC videos I realised I couldn’t keep putting off using storyboards and auto layout - it was only going to get more difficult the longer I left it.</p>

<p>So I ended up scrapping the existing XIBs which defined the user interface and moved everything to a single storyboard (the app’s small so I could get away with that). Though I’d not used auto layout extensively I managed to convert everything without much bother - aside from one UI element which consisted of a set of tableviews in a paginated scrollview, one for each venue on a given day. Try as I might I couldn’t get it paging properly through Interface Builder (I suspect I need to manage it in code, as the tables are dynamic) so I ended up replacing the scrollview with a single tableview, which luckily I could do since the festival takes place on a single day this year - there’s less data to display.</p>

<p>Here’s the cool thing though - I estimate I spent no more than 2 days’ worth of time preparing the app for 2014, which is a significant improvement on previous years. I didn’t miss half of a conference this time either! The infrastructure that’s now in place should provide a consistent base from which I can experiment with new features. Here’s hoping Apple now slow down a bit so I can spend less time firefighting in future.</p>

<h2>Final Thoughts</h2>

<p>In a nutshell, here&rsquo;s what I’ve learned from developing this app over the last four years:</p>

<ul>
<li>Abstraction frameworks are useful for quick prototyping</li>
<li>Don’t waste time on features if they aren’t likely to be used (however cool you think they may be!)</li>
<li>If your app depends on a dataset but has a deadline, submit as early as possible and update it on first launch</li>
<li>Each year, run your app with the new iOS beta releases as soon as they’re available to identify what needs fixing, even if you don’t plan on updating it in the near future - avoid late surprises.</li>
<li>The WWDC videos are essential viewing</li>
<li>Where you can, own your own web services. Don’t rely on someone else’s platform and its performance, availability, etc.</li>
</ul>


<p>Phew. That&rsquo;s it. You have my thanks if you made it this far!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[UISplitViewController Collapsing and Separating in iOS 8]]></title>
    <link href="http://marvelley.com/blog/2014/09/27/uisplitviewcontroller-collapsing-and-separating-in-ios-8/"/>
    <updated>2014-09-27T22:39:43+00:00</updated>
    <id>http://marvelley.com/blog/2014/09/27/uisplitviewcontroller-collapsing-and-separating-in-ios-8</id>
    <content type="html"><![CDATA[<p>The new UISplitViewController class and delegate methods in iOS 8 is interesting, and caused me a lot of head scratching last week.
The problem Brent Simmons describes <a href="http://inessential.com/2014/09/27/uisplitviewcontroller_question">here</a>, where
after rotating the device from regular to compact size class and back again iOS uses the topmost master view controller
as the new detail view, instead of the previous detail view, is roughly the same issue I had.</p>

<p>As far as I can tell so far, I think the following approach solves the issue. Note that I don&rsquo;t think I have the same set up as
Brent - I have a navigation stack in each of the master and detail sides - but I think the general approach
is sound, based on advice from Apple in the the &ldquo;Building Adaptive Apps with UIKit&rdquo; session from this year&rsquo;s WWDC,
and the &ldquo;AdaptivePhotos&rdquo; sample app code they provide.</p>

<p>My UISplitViewController delegate looks like this:</p>

<div><script src='https://gist.github.com/c3cbbb717c3ef957cbbe.js'></script>
<noscript><pre><code>#import &quot;UISplitViewControllerDelegateService.h&quot;
#import &quot;NoteViewController.h&quot;

@interface UISplitViewControllerDelegateService () &lt;UISplitViewControllerDelegate&gt;

@end

@implementation UISplitViewControllerDelegateService

- (id)initWithSplitViewController:(UISplitViewController *)controller {
    
    self = [super init];
    if (!self) {
        return nil;
    }
    
    self.splitViewController = controller;
    controller.delegate = self;
    
    return self;
    
}

#pragma mark - Split view

- (BOOL)splitViewController:(UISplitViewController *)splitViewController collapseSecondaryViewController:(UIViewController *)secondaryViewController ontoPrimaryViewController:(UIViewController *)primaryViewController {
    
    if ([secondaryViewController isKindOfClass:[UINavigationController class]]
        &amp;&amp; [[(UINavigationController *)secondaryViewController topViewController] isKindOfClass:[NoteViewController class]]
        &amp;&amp; ([(NoteViewController *)[(UINavigationController *)secondaryViewController topViewController] note] == nil)) {
        // If the detail controller doesn't have an item, display the primary view controller instead
        return YES;
    }

    return NO;
    
}

- (UIViewController *)splitViewController:(UISplitViewController *)splitViewController
separateSecondaryViewControllerFromPrimaryViewController:(UIViewController *)primaryViewController{
    
    if ([primaryViewController isKindOfClass:[UINavigationController class]]) {
        for (UIViewController *controller in [(UINavigationController *)primaryViewController viewControllers]) {
            if ([controller isKindOfClass:[UINavigationController class]] &amp;&amp; [[(UINavigationController *)controller visibleViewController] isKindOfClass:[NoteViewController class]]) {
                return controller;
            }
        }
    }
    
    // No detail view present
    UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@&quot;Main&quot; bundle:nil];
    UINavigationController *detailView = [storyboard instantiateViewControllerWithIdentifier:@&quot;detailView&quot;];
    
    // Ensure back button is enabled
    UIViewController *controller = [detailView visibleViewController];
    controller.navigationItem.leftBarButtonItem = self.splitViewController.displayModeButtonItem;
    controller.navigationItem.leftItemsSupplementBackButton = YES;

    return detailView;
    
}

@end
</code></pre></noscript></div>


<ul>
<li>In the &lsquo;collapse&rsquo; method, which is called when the device rotates to portrait, we disregard the detail view controller and use the
master view controller if the detail view has no content</li>
<li>In the &lsquo;merge&rsquo; method, we look to see if there&rsquo;s a navigation controller which is displaying a NoteViewController (this controller
is currently only used as a detail view, exclusively, so it&rsquo;s a safe bet). If it exists, we use it - otherwise we retrieve the &lsquo;stock&rsquo;
note view controller stack from the storyboard and use that.</li>
</ul>


<p>This approach seems to have worked well so far. The majority of issues I&rsquo;ve found have been on the iPhone 6 Plus, which combines the
single hierarchy approach of the smaller form factor devices in regular mode, with the side-by-side dual view approach or the larger form factors
in compact mode - this hybrid strategy seems to require more direction on our part, whereas elsewhere iOS tends to guess right on its own.</p>

<p>A final note - having to manually ensure the back button exists and is configured on the detail view controller is a bit icky, but I needed
to do this to avoid a crash. I&rsquo;d love to hear from anyone with more elegant ways to handle this.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[NOOB 0.9.19 - 'You Shouldn't Have to Click It']]></title>
    <link href="http://marvelley.com/blog/2014/09/17/noob-0-dot-9-19-you-shouldnt-have-to-click-it/"/>
    <updated>2014-09-17T10:17:41+00:00</updated>
    <id>http://marvelley.com/blog/2014/09/17/noob-0-dot-9-19-you-shouldnt-have-to-click-it</id>
    <content type="html"><![CDATA[<p>Gav and myself mainly talk about software company processes and principles, with a little bit on communication tools and AWS thrown in for good measure.</p>

<p>This is the first podcast we&rsquo;ve recorded remotely, since Gav moved to Bristol. Following <a href="http://www.macworld.com/article/2030512/how-we-produce-our-podcasts.html">this Macworld post&rsquo;s directions</a> seemed to work; we each recorded our own audio via Quicktime, and synced it up with our &ldquo;master&rdquo; recording from Skype, made possible via <a href="http://ecamm.com/mac/callrecorder/">Call Recorder</a>. I sequenced it all in GarageBand, with the odd final edit in Audacity.</p>

<p>We&rsquo;re five episodes in since we rebooted the podcast back in June. There&rsquo;s still a lot of room for improvement (especially, for me, in my speech - I find it hard to speak in a slow cadence, and concentrating on that often distracts me from the topic at hand), but I feel that each episode has gained in professionalism, and they&rsquo;re a lot of fun to do.</p>

<p>Check it out on Soundcloud <a href="https://soundcloud.com/never-out-of-beta/you-shouldnt-have-to-click-it">here</a>, or even <a href="https://itunes.apple.com/gb/podcast/never-out-of-beta/id908946657?mt=2">subscribe on iTunes</a> thanks to Soundcloud&rsquo;s currently-in-beta integration with that service, which we&rsquo;re fortunate to have been given access to.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Waiting for SSH]]></title>
    <link href="http://marvelley.com/blog/2014/09/03/waiting-for-ssh/"/>
    <updated>2014-09-03T19:17:18+00:00</updated>
    <id>http://marvelley.com/blog/2014/09/03/waiting-for-ssh</id>
    <content type="html"><![CDATA[<p><strong>Update 2014/09/06</strong> - Michael DeHaan <a href="https://twitter.com/laserllama/status/507325690610728962">mentions on Twitter</a> that he adds in a few seconds of sleep with the pause module to ensure the SSH port is open.</p>

<p>I&rsquo;ve spent the day provisioning a whole lot of EC2 instances with Ansible from a control machine in the cloud. This involves two stages: firstly an instance is launched, and then once SSH is available (using Ansible&rsquo;s <code>wait_for</code> module), the second stage of more detailed provisioning begins.</p>

<p>An issue I&rsquo;d experienced a few times previously but had not been able to pinpoint, was that often the <code>wait_for</code> module failed to identify that SSH is ready. My Ansible task looked like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>- name: Wait until SSH is available
</span><span class='line'>  local_action: 
</span><span class='line'>    module: wait_for 
</span><span class='line'>    host: "{{ item.public_dns_name }}"
</span><span class='line'>    port: 22 
</span><span class='line'>    delay: 60 
</span><span class='line'>    timeout: 320 
</span><span class='line'>    state: started
</span><span class='line'>  with_items: launched_instances.instances</span></code></pre></td></tr></table></div></figure>


<p>That task would often time out, but in such cases if I were to immediately try to SSH from the terminal it would succeed, which was odd indeed.</p>

<p>Today this behaviour was consistent, and I eventually realised that in the task I was using the instance&rsquo;s public DNS name, whereas when I was connecting via the terminal I used the public IP address. Indeed, changing the task to use the IP address seems to have made the whole thing a lot more reliable:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>- name: Wait until SSH is available
</span><span class='line'>  local_action: 
</span><span class='line'>    module: wait_for 
</span><span class='line'>    host: "{{ item.public_ip }}"
</span><span class='line'>    port: 22 
</span><span class='line'>    delay: 60 
</span><span class='line'>    timeout: 320 
</span><span class='line'>    state: started
</span><span class='line'>  with_items: launched_instances.instances</span></code></pre></td></tr></table></div></figure>


<p>I&rsquo;m guessing that on my Mac (where this was rarely an issue) the DNS cache updates quicker than it does on the control machine in EC2, where this problem was more frequent - using the explicit IP address renders the issue moot.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Never Out of Beta Returns!]]></title>
    <link href="http://marvelley.com/blog/2014/06/09/never-out-of-beta-returns/"/>
    <updated>2014-06-09T14:26:18+00:00</updated>
    <id>http://marvelley.com/blog/2014/06/09/never-out-of-beta-returns</id>
    <content type="html"><![CDATA[<p>I love podcasts. Since I moved house and gained a commute I&rsquo;ve whiled away the time to and from work listening to <a href="http://daringfireball.net/thetalkshow/">The Talk Show</a>, <a href="http://therecord.co">The Record</a>, <a href="http://www.theguardian.com/football/series/footballweekly">The Guardian&rsquo;s Football Weekly</a>, and a couple of other great shows. Enough that I&rsquo;m barely able to listen to them all. They made me pine for <a href="http://www.neveroutofbeta.com">Never Out Of Beta</a> though, a podcast <a href="https://twitter.com/gavD_UK">Gav</a> and <a href="https://twitter.com/handybitesize">Carey</a> started a couple of years ago that I and a few friends would guest on, which was great fun.</p>

<p>But my longing is over - Gav and I have rebooted the show, and the <a href="https://soundcloud.com/never-out-of-beta/episode-0-2-1-its-not-in-my">first episode is available now</a> via Soundcloud!</p>

<p>A couple of notes:</p>

<ul>
<li>Production &ldquo;issues&rdquo; (well, I forgot a bunch of audio equipment) meant that we had to record this one via my Macbook&rsquo;s built in microphone. It turned out ok, but we&rsquo;ve got higher standards which hopefully we&rsquo;ll get closer to next time</li>
<li>It took longer than I&rsquo;d have liked to get the episode out because I&rsquo;m learning the ropes when it comes to editing. The WWDC stuff is a bit old hat now, but get past that and I think there&rsquo;s some interesting discussion around the DevOps mindset and provisioning with Ansible</li>
<li>An iTunes feed is coming as soon as I can sort one out - I listen to podcasts through the Apple Podcast app so I&rsquo;m eager to make it available there</li>
<li>Inspired by The Talk Show&rsquo;s recent switch we&rsquo;re hosting the show on SoundCloud, which has been perfect so far</li>
</ul>


<p>As with pretty much everything else Gav and I do, it might take a few iterations before this is something we&rsquo;re really happy with, and feedback to aid us in getting there will be very much appreciated.</p>

<p>If you like tech, you might like this. Check it out!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Handling Interactive Ansible Tasks]]></title>
    <link href="http://marvelley.com/blog/2014/04/23/handling-interactive-ansible-tasks/"/>
    <updated>2014-04-23T09:40:10+00:00</updated>
    <id>http://marvelley.com/blog/2014/04/23/handling-interactive-ansible-tasks</id>
    <content type="html"><![CDATA[<p>I recently re-ran some Ansible provisioning scripts after upgrading the
base box to an Ubuntu 14.04 image and found they stalled midway through. The cause? One
task involved installing the PECL mongo module, and the installation process now prompts
the user to decide whether or not to build with Cyrus SASL support. I couldn&rsquo;t see a way to force
a decision via the PECL installer, and Ansible can&rsquo;t
respond to the prompt, so the provisioning process hung while awaiting an answer.</p>

<p>I found two ways to solve this.</p>

<h2>I&rsquo;ve been expecting you</h2>

<p>I did a bit of Googling and after coming across <a href="https://groups.google.com/forum/#!topic/ansible-project/pMy2VWgkQ1s">this post</a>
on the Ansible forum, I took a look at <a href="http://linux.die.net/man/1/expect">expect</a>. Expect lets you
script interactions with a spawned command, using regex to match against prompt text, and send
appropriate responses. It&rsquo;s a sound approach; I wrote a script that looked like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#!/usr/bin/expect
</span><span class='line'>
</span><span class='line'>spawn pecl install mongo
</span><span class='line'>
</span><span class='line'>expect "Build with Cyrus SASL"
</span><span class='line'>send "\r"
</span><span class='line'>
</span><span class='line'>expect eof</span></code></pre></td></tr></table></div></figure>


<p>And executed it on the box using Ansible&rsquo;s <code>script</code> module:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>- name: Install PECL mongo extension
</span><span class='line'>  script: install_pecl_mongo.expect</span></code></pre></td></tr></table></div></figure>


<p>Mission achieved. I felt very pleased with myself for about 30 seconds, which is
how long it took for Paul to wander over and tell me there was a simpler way to do it.
Expect is a really good solution for scripting varied or complex responses, but I wasn&rsquo;t
faced with that problem here&hellip;</p>

<h2>Yes man</h2>

<p>In this specific case, all I wanted to do was answer a prompt which needed a yes or no
answer, and I wasn&rsquo;t concerned which I went with. There&rsquo;s a linux command
called <a href="http://en.wikipedia.org/wiki/Yes_(Unix">yes</a> which &ldquo;outputs an affirmative response,
or a user-defined string of text continuously until killed&rdquo;, which is just what I needed.</p>

<p>So now my task looks like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>- name: Install PECL mongo extension
</span><span class='line'>  shell: yes '' | pecl install mongo</span></code></pre></td></tr></table></div></figure>


<p>Which continuously pipes the &lsquo;y&rsquo; character (by default) and a newline character into
the install command, automatically causing any prompts to be responded to in the
affirmative. For my simple use case it works perfectly, and is more straightforward than
writing expect scripts.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Local Provisioning With Ansible]]></title>
    <link href="http://marvelley.com/blog/2014/04/11/local-provisioning-with-ansible/"/>
    <updated>2014-04-11T21:24:00+00:00</updated>
    <id>http://marvelley.com/blog/2014/04/11/local-provisioning-with-ansible</id>
    <content type="html"><![CDATA[<p>I recently <a href="http://marvelley.com/blog/2014/03/18/vagrant-1-dot-5-syncing-situation/">mentioned</a>
I&rsquo;m going all-in on provisioning and running all my development
environments in VMs provisioned with Ansible. My Ansible use doesn&rsquo;t end there though -
I&rsquo;m also using it to provision my MacBook.</p>

<p>I&rsquo;d read of a few other people doing this - Benjamin Eberlei has a particularly
<a href="http://whitewashing.de/2013/11/19/setting_up_development_machines_ansible_edition.html">good post</a>
on the topic, and was pretty much the inspiration for me doing the
same. Setting up a new machine can be a bit of a bore, and while in theory it
only happens whenever I upgrade hardware I have been caught out in the past with kernel
corruption forcing a reinstall, and I&rsquo;d like
to minimise the hassle should it ever happen again. I have <a href="http://backblaze.com">backups</a>
, but one of the few upsides of going back to scratch with a machine is that it&rsquo;s an
opportunity for spring clean; a script that effectively lists all the essential
components of my computer, and configures them to my taste, makes that so much easier.</p>

<p>Anyway. A couple of people mentioned they&rsquo;d be interested in the playbooks I wrote
to provision my laptop, so I&rsquo;ve taken out anything personal to me and <a href="https://github.com/craigmarvelley/macbook-provisioning">mirrored them
on Github</a>.</p>

<p>Currently the provisioning involves four things:</p>

<ul>
<li>Install Homebrew and various brews</li>
<li>Install Homebrew Casks and various casks</li>
<li>Enable zsh as default shell and install oh-my-zsh</li>
<li>Install dotfiles to configure git, vim, etc. (my dotfiles repo is <a href="https://github.com/craigmarvelley/dotfiles">here</a>)</li>
</ul>


<p>It&rsquo;s all straightforward, but a couple of implementation details:</p>

<ul>
<li>I&rsquo;ve ended up using Alfred as my OS X search tool because I store my casks under <code>/usr/local</code>
with the other brew stuff and symlink to /Applications, and Spotlight doesn&rsquo;t
grok symlinks. Instead I configure Alfred to link in the cask files</li>
<li>I read on a few places on the web that the method I use to determine my current shell
process - <code>echo $SHELL</code> - isn&rsquo;t foolproof. Works for me, but YMMV</li>
</ul>


<p>There&rsquo;s more I could do in terms of what I manage, especially when it comes to
dotfile configuration (incidentally one of the best things about automating
provisioning in this way is you end up looking at other people&rsquo;s approaches,
and finding out about libraries and tools that you never even knew existed - <a href="http://robots.thoughtbot.com/rcm-for-rc-files-in-dotfiles-repos">Thoughtbot&rsquo;s rcm</a>
is one such example here).
Also I&rsquo;m still finding my way with Ansible, so my playbooks can undoubtedly be improved, especially
when it comes to idempotency.
Nevertheless I&rsquo;m really happy to have a record of my machine&rsquo;s starting state, and will enjoy adding to it as time
passes.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Vagrant 1.5 Syncing Situation]]></title>
    <link href="http://marvelley.com/blog/2014/03/18/vagrant-1-dot-5-syncing-situation/"/>
    <updated>2014-03-18T09:39:02+00:00</updated>
    <id>http://marvelley.com/blog/2014/03/18/vagrant-1-dot-5-syncing-situation</id>
    <content type="html"><![CDATA[<p><img src="http://marvelley.com/images/posts/2014/03/synchronised.jpg" alt="image" /></p>

<p>When starting work at <a href="http://www.bipsync.com">BipSync</a> I resolved to put the bits
and bobs I&rsquo;d learned about provisioning with Vagrant and Ansible into practice, and
no longer host development environments locally on my MacBook. The reasons were
twofold - firstly I wanted my development environment to mirror that
of live as closely as possible, and secondly when previously hosting multiple,
complex projects on one machine I experienced increased battery drain and frequent
slowdowns caused by active background services that I often didn&rsquo;t even need for my current
task. It was a pain to keep track of everything, especially when multiple versions
were required. So the attraction of having dev environments I could bring up and down, and if
necessary occasionally trash, was a strong one.</p>

<p>I&rsquo;d played with Vagrant / VirtualBox hosted projects on smallish codebases before,
where the default VirtualBox synced folder support was sufficient; however when
attempting to host and develop BipSync&rsquo;s sizeable applications it was quickly clear
that this combination wouldn&rsquo;t be fast enough to be fit for purpose.</p>

<p>Since VirtualBox has been <a href="http://puppetlabs.com/blog/new-vmware-provider-gives-vagrant-a-boost">acknowledged</a>
as the slowest of Vagrant&rsquo;s provider options, and we already had Parallels
licences for the development of our Windows applications, next I tried out the
third party <a href="https://github.com/Parallels/vagrant-parallels">Parallels plugin for Vagrant</a>.
Basically this was a non-starter - I immediately ran into bugs that were present in the project&rsquo;s
issue tracker, and the impression I got was that the plugin is still a work-in-progress.
The plugin is overseen by Parallels so I&rsquo;m optimistic that it&rsquo;ll one day be a
first-class provider, but as it was it was unusable.</p>

<p>So I went back to VirtualBox (VMWare was another option but before forking out money on the
software and accompanying plugin I wanted to exhaust all other options) and tried the other
synced folder types. First I tried the new rsync support, which I&rsquo;d <a href="https://www.vagrantup.com/blog/feature-preview-vagrant-1-5-rsync.html">read good things
about</a>. In terms of speed this was very quick because there isn&rsquo;t really a share to speak
of; shared items are copied to the guest rather than mounted. It requires a command
to be run constantly, to watch synced files for changes and copy them to the guest, and
this proved to be a problem; as <a href="https://github.com/mitchellh/vagrant/issues/3249">issues raised</a>
by others attest, the approach wasn&rsquo;t scaling to large (20k+ files) codebases, which
is common in my experience. I tried excluding some folders to see if that would help,
but it didn&rsquo;t.</p>

<p>So after all that I ended up using the NFS sync option, which aside from requiring
a password for sudo when booting the VM has proved trouble free, so far. Performance
is good, both in terms of the applications themselves, and when browsing and modifying files
in the share; I&rsquo;ve seen PHPStorm occasionally lock up but then it always has ;) It&rsquo;s
certainly good enough to work with now, and I&rsquo;ll be keeping an eye on the rsync and Parallels
options as they should improve in time.</p>

<p>(&ldquo;Moonlight Synchro&rdquo; image courtesy of <a href="http://www.flickr.com/photos/72562013@N06/12765457844/">Chris Phutully</a>. <a href="https://creativecommons.org/licenses/by/2.0/">See license</a>.)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Goodbye Box UK, Hello BipSync]]></title>
    <link href="http://marvelley.com/blog/2014/03/06/goodbye-box-uk-hello-bipsync/"/>
    <updated>2014-03-06T23:08:01+00:00</updated>
    <id>http://marvelley.com/blog/2014/03/06/goodbye-box-uk-hello-bipsync</id>
    <content type="html"><![CDATA[<p>For the last 7 years I consider myself lucky to have been employed by Box UK. When I joined in 2007 I&rsquo;d spent the previous 3 years writing what I consider &lsquo;despite software&rsquo;. Software that did its job despite the efforts of the developer behind it. I was guilty of pretty much every bad practice at some stage; a direct result of me being the sole developer within both my company and my social circles. I didn&rsquo;t know better and had no-one to tell me otherwise, but by 2007 I knew I needed to address that by working for a company in which there were lots of people smarter and more experienced than me. To &ldquo;aim to be the dumbest person in the room&rdquo;, as it&rsquo;s often put - and never better than by my colleague and mentor at Box UK, <a href="http://twitter.com/handybitesize">Carey Hiles</a>, <a href="http://vimeo.com/37279704">speaking about being a lone coder</a> in the first <a href="http://unifieddiff.co.uk">Unified Diff</a> meetup put on several years later.</p>

<p>My first assignment at Box UK was making some tweaks to a web form on <a href="http://www.prometheanworld.com/gb/english/education/home/">Promethean&rsquo;s</a> e-commerce site. My last assignment was rearchitecting the technology behind <a href="http://www.careerswales.com">careerswales.com</a>, a multi-application portal serving millions of users, which is destined to help shape lives of the people of Wales for years to come. In between I&rsquo;ve created mobile applications, written web services, ported databases, implemented designs, discovered search platforms, pushed to queues, knocked out specifications, made many a calculation and finally - finally - got to grips with git. I&rsquo;ve taught schoolchildren how to code. I&rsquo;ve also shared more in-jokes than you could shake a stick at. Seriously.</p>

<p>As a software developer, I can&rsquo;t think of a better place to learn one&rsquo;s trade; every couple of months a new project comes along which will either improve existing skills, or demand new ones. Through the work that I&rsquo;ve done there I&rsquo;ve had the opportunity to travel the world, meet heroes, and <a href="http://www.youtube.com/watch?v=g2f_BzKrpaU&amp;list=PLo7mBDsRHu11HSkEucxDIAxeBZUJp10Jn&amp;index=5">speak at conferences</a>. My colleagues have been everything I&rsquo;d hoped they&rsquo;d be - smart, friendly, and more than happy to help. Most importantly, they&rsquo;re passionate. Box UK have aimed to only hire those who care about the work they do, and that&rsquo;s clearly reflected in what we&rsquo;ve achieved.</p>

<p>TL/DR: I&rsquo;ve had an amazing job these last 7 years, and have loved every single minute of it.</p>

<p>After seven years I&rsquo;m ready for a new challenge, and a wonderful opportunity at a startup called <a href="http://bipsync.com">BipSync</a> means it&rsquo;s time to move on. I&rsquo;ll be working with some former colleagues on some exciting software in a domain that&rsquo;s fresh and interesting. I can&rsquo;t wait to get stuck in, and hopefully share my experiences. I&rsquo;d like to thank all at Box UK, especially Benno and those with whom I worked closely with over the years, for all the opportunities I was given and the experiences I&rsquo;ve had. You&rsquo;ve undoubtedly made me a better person, and I wish you all the best for the future.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Restore Missing Audio in iMovie for Mac]]></title>
    <link href="http://marvelley.com/blog/2014/02/17/restore-missing-audio-in-imovie-for-mac/"/>
    <updated>2014-02-17T08:45:26+00:00</updated>
    <id>http://marvelley.com/blog/2014/02/17/restore-missing-audio-in-imovie-for-mac</id>
    <content type="html"><![CDATA[<p><img src="http://farm1.staticflickr.com/169/414411019_e702aa6d54_o.jpg" alt="image" /></p>

<p>I recently got a new Macbook (running Mavericks) and wanted to transfer the iMovie projects from my older machine (running Mountain Lion). The new machine featured the most recent version of iMovie (iMovie for Mac, version 10.0.2) while my old one was on 9.0.9.</p>

<p>I loaded the projects into iMovie for Mac by copying over the <code>iMovie Events</code>, <code>iMovie Original Movies</code> and <code>iMovie Projects</code> folders via AirDrop. Upon starting iMovie for Mac it prompted me to upgrade my projects to the new format. After some time a dialog appeared notifying me that some events had not been found, and that the upgrade had not been successful.</p>

<p>It turned out that the movie events were fine, but the background audio I&rsquo;d added (via iTunes) was missing because I&rsquo;d not copied over my iTunes folder (and hadn&rsquo;t planned to, since I now use iTunes in the Cloud). Attempting to open a ported project gave me a dialog along the lines of &lsquo;Upgrade now, with missing events, or upgrade later&rsquo; - the choice was inconsequential since even by choosing &lsquo;Upgrade later&rsquo; before putting the tracks in the places they were expected before opening the movie, the movie didn&rsquo;t seem to pick up on the fact that they were now there. The waveforms remained blank, and the audio didn&rsquo;t play. Of course, in most cases I didn&rsquo;t even know which files were missing because most of these movies were put together months ago.</p>

<p>I eventually fixed it by painstakingly downloading and importing each audio track into the movie alongside the original clip, which triggered a reload of the original. Then the second clip could be removed, leaving the original which now played. It would be nice if iMovie for Mac had a &lsquo;reload all events in this movie&rsquo; feature (perhaps it does, and I couldn&rsquo;t find it - I&rsquo;ve never found iMovie to have the most intuitive of interfaces)- thankfully I only had 20 or so tracks to fix, but for some more hardcore users it could be a lot worse.</p>

<p>(Waveform image copyright <a href="http://www.flickr.com/photos/topgold/414411019/">Bernard Goldbach</a>)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Understanding DNS]]></title>
    <link href="http://marvelley.com/blog/2014/02/14/understanding-dns/"/>
    <updated>2014-02-14T09:53:02+00:00</updated>
    <id>http://marvelley.com/blog/2014/02/14/understanding-dns</id>
    <content type="html"><![CDATA[<p>I&rsquo;ve never really taken the time to read up on how DNS works. Ten years of web development mean I&rsquo;ve gradually assumed a pretty good idea through trial and error, but I&rsquo;ve never really felt 100% confident that I know what I&rsquo;m doing when registering and administering domain names, particularly when it comes to more obscure record types like <a href="http://www.zytrax.com/books/dns/ch9/spf.html">SPF</a>. Things work, but I don&rsquo;t <em>really</em> know why.</p>

<p>I was shopping for a domain name the other day and while on the DNSimple website I was invited to receive a series of emails that offered to outline the DNS basics. I batted away my initial reluctance to sign myself up for spam, and I&rsquo;m glad I did - the lessons are nicely written, short and to the point, and thankfully aren&rsquo;t just an excercise in advertising for the registrar. I&rsquo;ve learned a couple things and reinforced my knowledge of others. I can&rsquo;t find a signup link now, but I do recommend them to anyone who wants to learn more about DNS.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Box UK Has an Engineering Blog]]></title>
    <link href="http://marvelley.com/blog/2014/02/04/box-uk-has-an-engineering-blog/"/>
    <updated>2014-02-04T07:53:34+00:00</updated>
    <id>http://marvelley.com/blog/2014/02/04/box-uk-has-an-engineering-blog</id>
    <content type="html"><![CDATA[<p>I&rsquo;ve always enjoyed reading <a href="http://en.wikipedia.org/wiki/Microblogging">microblogs</a> like <a href="http://daringfireball.net/">Daring Fireball</a> which briefly editorialise links to content elsewhere on the web - it&rsquo;s like &ldquo;Here&rsquo;s something interesting, here&rsquo;s some perspective on it, now go read it.&rdquo;. While we&rsquo;ve had a blog on the Box UK website for some time, the format of it has been very much long-form. While that means we produce lots of in depth, informative content, the downside is because it can take a while to turn posts around the blog doesn&rsquo;t suit snappy, quick posts in the microblog style.</p>

<p>Internally, we&rsquo;re always sharing links to posts or videos in <a href="https://www.hipchat.com/">HipChat</a> - stuff that&rsquo;s relevant to our day-to-day work, stuff that could be useful to us in future, that sort of thing. For a while it&rsquo;s been on our roadmap to introduce a microblog on the <a href="http://www.boxuk.com/">Box UK website</a>, and now we have - last week we lauched the <a href="http://www.boxuk.com/developer-blog/">Box UK developer blog</a>. We&rsquo;ve already had posts on varied topics like SSH, Objective-C, Vim and Amazon S3. Keep an eye on it!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Including Filtered Thumbnail Data With the WordPress JSON API Plugin]]></title>
    <link href="http://marvelley.com/2013/09/26/including-filtered-thumbnail-data-with-the-wordpress-json-api-plugin/"/>
    <updated>2013-09-26T00:00:00+00:00</updated>
    <id>http://marvelley.com/2013/09/26/including-filtered-thumbnail-data-with-the-wordpress-json-api-plugin</id>
    <content type="html"><![CDATA[<p>The <a href="http://wordpress.org/plugins/json-api/">JSON API</a> plugin is a great tool for exposing your WordPress data. I&#8217;ve used it to provide content to a few mobile applications; it&#8217;s well featured and most importantly, quite flexible. If your content providers are happiest using a CMS like WordPress, your project can benefit by allowing them to use the authoring tools they&#8217;re comfortable with while allowing you to easily access the content they&#8217;re creating, either to use directly within your application, or as I tend to do, by exporting the data into another application which then proxies the data to mobile applications. I find the latter approach gives you greater control over features like caching, while making it easier to relate the data to domain models that aren&#8217;t handled by WordPress.</p>

<p>But I digress! This post was conceived because when requesting all posts of a certain type through the plugin, response times were hideously slow. The request I was making looked like this:</p>

<p><a href="http://domain.com/?json=get_posts&amp;post_type=artist&amp;count=1000&amp;order=ASC">http://domain.com/?json=get_posts&amp;post_type=artist&amp;count=1000&amp;order=ASC</a></p>

<p>Reading the documentation for the plugin, I found that it was possible to filter the response to only contain properties that I wanted, which I figured should reduce the amount of work WordPress was having to do:</p>

<p><a href="http://domain.com/?json=get_posts&amp;post_type=artist&amp;count=2&amp;order=ASC&amp;include=id,title,content,custom_fields,thumbnail_images">http://domain.com/?json=get_posts&amp;post_type=artist&amp;count=2&amp;order=ASC&amp;include=id,title,content,custom_fields,thumbnail_images</a></p>

<p>This proved to be true, but I hit a snag when trying to include the thumbnail_images property &#8211; adding it to the CSV of whitelisted fields had no effect. Through trial and error it transpired that including the thumbnail field also has the effect of including the thumbnail, thumbnail_size, and thumbnail_images fields. The final URL ended up looking like this:</p>

<p><a href="http://domain.com/?json=get_posts&amp;post_type=artist&amp;count=2&amp;order=ASC&amp;include=id,title,content,custom_fields,thumbnail">http://domain.com/?json=get_posts&amp;post_type=artist&amp;count=2&amp;order=ASC&amp;include=id,title,content,custom_fields,thumbnail</a></p>

<p>Problem solved!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[On Incremental Improvement]]></title>
    <link href="http://marvelley.com/2013/01/06/on-incremental-improvement/"/>
    <updated>2013-01-06T00:00:00+00:00</updated>
    <id>http://marvelley.com/2013/01/06/on-incremental-improvement</id>
    <content type="html"><![CDATA[<p>Twice today I&#8217;ve seen references to the benefits of iterative improvement, and I found that the topic resonated with me. At the moment I&#8217;m halfway though a pretty lengthy software project in which it&#8217;s sometimes hard to see the wood for the trees. The backlog is substantial, resulting in a hefty set of tasks for our team. In these situations, where the to-do list doesn&#8217;t seem to change day to day, it&#8217;s easy to feel crippled by inertia. However, these two references illustrate that we can succeed provided we ensure we&#8217;re making healthy, gradual progress.</p>

<p>One might expect that the references I&#8217;m alluding to originate from a tome of software development, like &#8220;<a href="http://pragprog.com/the-pragmatic-programmer">The Pragmatic Programmer</a>&#8220;, or from one of the many celebrated development gurus of Twitter, but in fact they are not directly concerned with software at all. The first comes from <a href="http://www.youtube.com/watch?v=7GHhmgZ0BwQ" title="The Undercover Economist Tim Harford: Full talk from Wired 2012">a talk discussing the pros and cons of iterative improvement</a> , linked to by my colleague (and all-round good chap) <a href="https://twitter.com/owenphelps" title="Owen Phelps' Twitter">Owen Phelps</a>, by Tim Harford at last year&#8217;s Wired UK conference:</p>

<blockquote><p>If you put together enough marginal improvements, in enough areas, you get something that&#8217;s truly outstanding.</p></blockquote>

<p>Give it a watch &#8211; it&#8217;s entertaining and informative.</p>

<p>The second reference came from an altogether different source &#8211; <a href="http://www.soundonsound.com/sos/jan13/articles/it-0113.htm" title="Alan Moulder: Sound on Sound January 2012">an interview with renowned mix engineer Alan Moulder</a> in this month&#8217;s issue of Sound on Sound magazine, in which he discusses his approach when applying VST plugins to his music projects:</p>

<blockquote><p>All the things I use do something to make the sound a tiny bit better, and if  you add everything together, the end result will be a lot better&#8230; It&#8217;s simple: better is better, whether it&#8217;s a tiny bit better or a lot better.</p></blockquote>

<p>Through never-ending sprints, features and tasks, iterative improvement is something all development teams should strive to achieve.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Symfony2: JSON Responses for XHR Errors and Authentication Failures]]></title>
    <link href="http://marvelley.com/2012/12/20/symfony2-json-responses-for-xhr-errors-and-authentication-failures/"/>
    <updated>2012-12-20T00:00:00+00:00</updated>
    <id>http://marvelley.com/2012/12/20/symfony2-json-responses-for-xhr-errors-and-authentication-failures</id>
    <content type="html"><![CDATA[<p>I&#8217;ve been working on a Symfony2 application whose user interface is presented as a single page application that makes heavy use of JavaScript. The app sends <a href="http://en.wikipedia.org/wiki/XMLHttpRequest">XHR</a> requests to the Symfony2 backend API to retrieve and modify data, and it uses Symfony&#8217;s authorisation/authentication functionality to protect resources so they are only accessible to logged in users.</p>

<p>In an ideal world every request made by the application will succeed, but in reality things often go wrong; the user may have provided invalid data, their session may have expired meaning they are no longer logged in, or we may have a bug in our API code which causes a server error. With an out-of-the-box installation of Symfony2, each of these scenarios will result in the default error handler rendering a HTML page which isn&#8217;t much use to our client JavaScript application &#8211; instead we want the server to issue a JSON response to our AJAX request, complete with some contextual error details, with which we can give the user a meaningful error message.</p>

<p>I did a bit of Googling and came across a <a href="http://stackoverflow.com/questions/8607212/symfony2-ajax-login">few</a> <a href="https://groups.google.com/forum/?fromgroups=#!topic/symfony-devs/WvESDBprKrU">posts</a> <a href="http://stackoverflow.com/questions/12385923/handle-errors-in-ajax-within-symfony2-controller">which</a> dealt with some of these challenges, and by putting them all together I arrived at a solution which I&#8217;ll detail here in case it&#8217;s of use to anyone else.</p>

<p><a href="https://github.com/craigmarvelley/symfony2-xhr-error-handling">I&#8217;ve put together a demo app</a> which hopefully illustrates everything. Have a play with it (installation instructions are in the README), then read on <img src='http://marvelley.com/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /></p>

<p><a href="http://marvelley.com/images/posts/2012/12/Screen-Shot-2012-12-20-at-21.55.12-e1356040628744.png"><img class="aligncenter size-full wp-image-341" title="The demo application" src="http://marvelley.com/images/posts/2012/12/Screen-Shot-2012-12-20-at-21.55.12-e1356040628744.png" alt="" width="600" height="398" /></a></p>

<p>The app consists of a few components:</p>

<p>Client side:</p>

<ul>
<li>A jQuery global AJAX error handler</li>
<li>A login form &#8211; I have two, a Symfony2/Twig-based HTML login page which the user is redirected to if they try to access the app without a valid session, and a JavaScript login dialog which we will display if the server rejects an AJAX request due to authentication/authorisation failure, allowing the user to reauthenticate without leaving the app</li>
</ul>


<p>Server side:</p>

<ul>
<li>An authentication failure handler</li>
<li>An authentication success handler</li>
<li>A kernel exception listener</li>
</ul>


<p>As far as the rest of the app goes, I&#8217;m using the <a href="https://github.com/FriendsOfSymfony/FOSUserBundle/blob/master/Resources/doc/index.md">FOSUserBundle</a> with a standard configuration, which supplies the rest of the auth functionality, including the HTML login page.</p>

<p>Let&#8217;s start with the server components &#8211; three classes and a bit of config:</p>

<p><noscript>
  <p>
    View the code on <a href="https://gist.github.com/4340230">Gist</a>.
  </p>
</noscript></p>

<p>The <code>XHRAuthenticationSuccessHandler</code> and <code>XHRAuthenticationFailureHandler</code> class&#8217; code is triggered when the user logs in, or fails to log in, respectively. We check to see if the original request was an AJAX (XHR) one, and if so we respond with JSON. If it&#8217;s a failure we&#8217;re dealing with, we also include the exception message to give the user some feedback &#8211; note that this is a quick solution; it might be prudent to vet the message, or to translate it. I&#8217;ve also included a &#8216;success&#8217; property which is a JavaScript convention that some frameworks (like <a href="http://www.sencha.com/products/extjs">ExtJS</a>) use to execute appropriate callbacks. Finally, we wire up these handlers with the security component in our application&#8217;s <a href="https://gist.github.com/4340230#file-security-yml">security configuration</a>.</p>

<p>The <code>XHRCoreExceptionListener</code> class code is triggered whenever a kernel exception occurs &#8211; check the <a href="https://gist.github.com/4340230#file-services-xml">service definition</a> for this listener, you&#8217;ll see we tell Symfony to call its <code>onCoreException</code> method whenever an exception event is fired. Again, we only want to act if the request that caused the exception was an AJAX one. Assuming it is, we try to work out the status code to return from the exception code &#8211; if it&#8217;s a valid HTTP code, we use that, otherwise we assume a server error (500). As before, we&#8217;re reusing the exception message to provide context &#8211; but in this case, where the exception could relate to anything in the system (like a database query) we&#8217;d really want to be cautious about exposing it to the user, so this code certainly isn&#8217;t suitable for a production environment.</p>

<p>That&#8217;s it for the server, now for the client. All the functionality is in <code>src/Acme/DemoBundle/Resources/views/Welcome/index.html.js</code>.</p>

<p>First we define a global error handler, which will be fired whenever an uncaught AJAX error occurs:</p>

<p><noscript>
  <p>
    View the code on <a href="https://gist.github.com/4348746">Gist</a>.
  </p>
</noscript></p>

<p>If the problem is that the user does not have a valid authentication token, we invite them to log in.</p>

<p><noscript>
  <p>
    View the code on <a href="https://gist.github.com/4348760">Gist</a>.
  </p>
</noscript></p>

<p>The login process is interesting &#8211; the modal login form is essentially a duplicate of the HTML one, but lacks the CSRF token which is automatically injected into the HTML form by Symfony. This helps prevent spoofing so I didn&#8217;t want to remove it, so the approach I took was to request the HTML login page, capture the value of the CSRF field in the response, then use that in a second request to actually authenticate the user. This meant I could reuse the same authentication code on the server.</p>

<p>The demo app also includes two other demonstrations &#8211; making a valid request (which will fail, and force a login, if the user does not have a valid session) and an invalid one (which displays the error message returned by the server). There&#8217;s not much to say about those, the code should be self explanatory.</p>

<p>That&#8217;s it really. The code is a little rough and ready, but hopefully it&#8217;ll give you enough to go on if you&#8217;re trying to do something similar!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Symfony2: Managing a User Entity Role With a Form Event Subscriber]]></title>
    <link href="http://marvelley.com/2012/11/10/symfony2-managing-a-user-entity-role-with-a-form-subscriber/"/>
    <updated>2012-11-10T00:00:00+00:00</updated>
    <id>http://marvelley.com/2012/11/10/symfony2-managing-a-user-entity-role-with-a-form-subscriber</id>
    <content type="html"><![CDATA[<p>I&#8217;m working on a Symfony2 application which makes use of roles to manage what Users of the system are able to do within the app. Symfony places no limit on the amount of roles the User can have, but in the context of my application, there are only two &#8211; a base user (ROLE_USER, in Symfony parlance), and an administrator (ROLE_ADMIN). As is Symfony custom, all users would possess the default role, but the administrator role would be granted on a per user basis. I&#8217;m using the FOSUserBundle and Doctrine, so a User&#8217;s roles are stored within an array on that User&#8217; Doctrine entity.</p>

<p>I began crafting a form (using the Symfony Form component) to manage user details. When creating forms that are bound to Doctrine I&#8217;ve generally found that I&#8217;ve needed to do little in the way of form customisation; the form component does a good job of figuring out which form fields to use based on the type of the variable it is given. So name, being a string, gets modelled as a textfield, while their registration date, being a DateTime object, causes a series of select boxes to be created which allow dates and times to be entered. So far so good.</p>

<p>But of course there has to be a reason for a blog post, and this is mine: I wanted a checkbox to toggle on/of the administrator role for each user. Since roles are stored in an array on the bound entity, the default is to render a collection of fields, which leads to an array of values being submitted by the form. Trying to modify the field definition to a &#8216;single&#8217; field, like a checkbox, led to an error as the Form component doesn&#8217;t know how to map an array to a single value. A multi-value field wasn&#8217;t an option as I didn&#8217;t want to expose the roles (which wouldn&#8217;t necessarily make sense to an end user), and I didn&#8217;t want to get into messing about with Twig templates if I could help it; a bit of Googling led me to <a href="http://symfony.com/doc/current/cookbook/form/dynamic_form_generation.html">this article</a> on the cookbook, which describes how to dynamically add elements to forms using a Form event subscriber; this turned out to be just what I needed.</p>

<p>Reading through the cookbook article, the following plan took shape: when the form is created, add a checkbox to the form which is ticked depending on whether the User object bound to the form has the administrator role. When the form is submitted, if the checkbox is ticked, grant the user that role. If it is not, remove the role from their array of granted roles.</p>

<p><a href="http://marvelley.com/images/posts/2012/11/Screen-Shot-2012-11-10-at-14.51.51.png"><img class="aligncenter size-full wp-image-311" title="The resulting form" src="http://marvelley.com/images/posts/2012/11/Screen-Shot-2012-11-10-at-14.51.51.png" alt="" width="793" height="491" /></a></p>

<p>To implement this, I needed two classes; a Form class, of course, and a new class that implements Symfony\Component\EventDispatcher\EventSubscriberInterface and subscribes to events on the form. As in the cookbook example, when the &#8216;preSetData&#8217; event fires I&#8217;d be adding a field to the form. In addition, when the &#8216;bind&#8217; event fires, I&#8217;d be using the value of the field to modify the bound object, in this case the User being managed. This is what I ended up with:</p>

<p><noscript>
  <p>
    View the code on <a href="https://gist.github.com/4051034">Gist</a>.
  </p>
</noscript></p>

<p>I&#8217;m manually adding the subscriber to the form in UserType::buildForm(), which feels a bit weird when the usual approach would be to define a service and tag it appropriately. I&#8217;m not sure if that&#8217;s possible with Form subscribers, that&#8217;s just how the cookbook approach went. I&#8217;d imagine there are other ways I could have achieved the same result, but I like this approach because I don&#8217;t have to modify my User class at all, and I don&#8217;t have to delve into form field customisation.</p>

<p>The only downside I&#8217;ve found so far is that there doesn&#8217;t seem to be a way to order the fields that get added in the listener &#8211; they are always placed at the start of the collection, regardless of when the subscriber is attached to the form. This means that some template work is necessary to place the field as desired.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Deactivating a Macports Install of XDebug in a LAMP Environment]]></title>
    <link href="http://marvelley.com/2012/09/20/deactivating-a-macports-install-of-xdebug-in-a-lamp-environment/"/>
    <updated>2012-09-20T00:00:00+00:00</updated>
    <id>http://marvelley.com/2012/09/20/deactivating-a-macports-install-of-xdebug-in-a-lamp-environment</id>
    <content type="html"><![CDATA[<p>A few times I&#8217;ve found myself cursing when trying to toggle <a href="http://xdebug.org/">XDebug</a> on and off via <a href="http://www.macports.org/">Macports</a>. Typically I&#8217;ll be debugging with it enabled, then disable it for development/testing to get the fastest experience possible (it tends to really impact performance on large codebases, such as a Symfony2 standard install), only to experience segfaults when I refresh the page I&#8217;m working on.</p>

<p>The solution I&#8217;ve found is when restarting Apache (which is necessary for the change to PHP&#8217;s installed modules takes effect), to use an explicit start/stop rather than a restart. <a href="http://httpd.apache.org/docs/2.2/stopping.html">According to the Apache docs</a> restarting only kills off children processes, so the parent remains running:</p>

<blockquote><p>Sending the <code>HUP</code> or <code>restart</code> signal to the parent causes it to kill off its children like in <code>TERM</code>, but the parent doesn&#8217;t exit. It re-reads its configuration files, and re-opens any log files. Then it spawns a new set of children and continues serving hits.</p></blockquote>

<p>I imagine this leading to a discrepancy in the loaded PHP modules, which causes the issue.</p>

<p>So when wanting to toggle XDebug, I use these commands:</p>

<pre>Install (first time only):
sudo port install php5-xdebug

Disable:
sudo port deactivate php5-xdebug
sudo apachectl stop
sudo apachectl start

Enable:
sudo port activate php5-xdebug
sudo apachectl stop
sudo apachectl start</pre>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Jeff Atwood Is a Muppet.]]></title>
    <link href="http://marvelley.com/2012/06/30/jeff-atwood-is-a-muppet/"/>
    <updated>2012-06-30T00:00:00+00:00</updated>
    <id>http://marvelley.com/2012/06/30/jeff-atwood-is-a-muppet</id>
    <content type="html"><![CDATA[<p>I was having a nice, relaxing Saturday morning until I read through my Twitter timeline and was directed to Jeff Atwood&#8217;s latest post on Coding Horror, &#8220;<a href="http://www.codinghorror.com/blog/2012/06/the-php-singularity.html">The PHP Singularity</a>&#8220;. After reading through it, and the comments from other readers, I got annoyed. Really annoyed.</p>

<p>I won&#8217;t repeat the article, but the gist of it is:</p>

<ul>
<li>PHP is a horrible language</li>
<li>Something must be done</li>
<li>Jeff is the person to do it</li>
</ul>


<p>I quite enjoy blogging but I don&#8217;t do it very often. I try to make sure anything I talk about is well researched, because a baseless opinion is worthless, but I don&#8217;t have a lot of free time &#8211; so if I don&#8217;t have something I consider worth saying, I don&#8217;t say it.</p>

<p>Jeff doesn&#8217;t have the same concern. You may wonder why I read his blog, given that I clearly take exception to some of its content, but the funny thing is that when talking about things he is knowledgable of, he has some great advice.</p>

<p>Like when he talks about <a href="http://www.codinghorror.com/blog/2011/10/on-parenthood.html">his children</a>, because he obviously knows them, or <a href="http://www.codinghorror.com/blog/2012/06/because-everyone-still-needs-a-router.html">routers</a>, where he&#8217;s clearly done some investigation. Now, I&#8217;m about to become a father, so I really enjoyed the former post, and if I needed to buy a router, I&#8217;d probably just be lazy and pick one from the latter because he knows a lot more about them than I do.</p>

<p>But here&#8217;s the thing. Jeff doesn&#8217;t seem to know much about PHP. I&#8217;d guess he&#8217;s read some posts about it, seen a few Q&amp;As on Stack Overflow about it (a site he deserves massive kudos for), read through the PHP Manual, whatever &#8211; but he&#8217;s not a PHP developer. When he says PHP is &#8216;terrible&#8217; or &#8216;deeply flawed&#8217;, I wonder how he&#8217;s come to that conclusion? Has he ever developed anything substantial in PHP? What is he basing this opinion on? He&#8217;s played with his children, he&#8217;s bought and installed a router. But when it comes to PHP, is the extent of his knowledge that which he has gleaned from others? Because if that&#8217;s the case, he really should think twice about offering his opinion on it.</p>

<p>The most glaring statement in the entire article is this one:</p>

<blockquote><p>Therefore, I&#8217;d like to submit a humble suggestion to my fellow programmers. The next time you feel the urge to write Yet Another Epic Critique of PHP, consider that:</p>

<ol>
<li>We get it already. PHP is horrible, but it&#8217;s used everywhere. Guess what? It was just as horrible in 2008. And 2005. And 2002. There&#8217;s a pattern here, but it&#8217;s subtle. You have to look very closely to see it. On second thought, never mind. You&#8217;re probably not smart enough to figure it out.</li>
<li>The best way to combat something as pervasively and institutionally awful as PHP is not to point out all its (many, many, <em>many</em>) faults, but to <strong>build compelling alternatives</strong> and <strong>make sure these alternatives are equally pervasive, as easy to set up and use as possible</strong>.</li>
</ol>
</blockquote>

<p>How anyone can offer a &#8216;humble&#8217; suggestion and then go on to question the reader&#8217;s intelligence is besides the point (though it does nicely illustrate Jeff&#8217;s technique of drawing the reader in with deference only to hit them with a massive dose of self-righteousness) &#8211; but there&#8217;s two things I really take exception to here. Firstly, as <strong>anyone</strong> who has spent any real time with PHP knows, the language is far, far different now to what it was in 2002. For heaven&#8217;s sake, PHP5 (with a brand new object model that made proper OOP possible) didn&#8217;t make its debut &#8217;til 2004, and support for register_globals (one of the worst features of PHP, ever) was removed in the most recent version, 5.4. Those facts are available under <a href="http://en.wikipedia.org/wiki/PHP">PHP&#8217;s entry on Wikipedia</a>, but perhaps Jeff&#8217;s not smart enough to Google the history of PHP before commenting on it?</p>

<p>Secondly; assuming for a second that PHP is as horrible as he deems it to be &#8211; the best way to &#8216;combat&#8217; it isn&#8217;t to &#8216;build compelling alternatives&#8217; and &#8216;make sure these alternatives are equally pervasive, as easy to set up and use as possible&#8217; &#8211; no, the &#8216;best&#8217; thing to do (considering the amount of developers and sites worldwide who depend on the language and are getting things done with it every single day) is <strong>get involved</strong> with and <strong>actually understand</strong> PHP &#8211; read the <a href="http://news.php.net/php.internals">internals mailing list</a>, make <a href="https://wiki.php.net/rfc">requests for comments</a>, code contributions, etc. It&#8217;s a silly person who decides to try something new before attempting to fix what&#8217;s broken, when there is so much invested in it. Perhaps if Jeff wasn&#8217;t trying to drum up interest in this new project of his, he&#8217;d have been a little less inflammatory?</p>

<p>Look, as someone who has used PHP successfully for the last decade, obviously I&#8217;m going to disagree with Jeff&#8217;s opinion. But the language has not only helped me get a great job, a nice house, and will shortly be helping me pay for one of those baby things, it&#8217;s also made Facebook the biggest website in the world, and enabled Yahoo! to build (ok, and throw away, but it&#8217;s not PHP&#8217;s fault) an empire. When Jeff&#8217;s got off his soap box and tried to build something equally successful in PHP <strong>and failed</strong>, I&#8217;ll start taking his opinion seriously.</p>

<p>As I said, I don&#8217;t like making statements unless I&#8217;ve researched them fully. I&#8217;ve read Coding Horror for a long time, and I feel qualified to say that Jeff Atwood is a <a href="http://www.urbandictionary.com/define.php?term=muppet&amp;defid=778738">muppet</a>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Resources for Learning Symfony2]]></title>
    <link href="http://marvelley.com/2012/05/27/resources-for-learning-symfony2/"/>
    <updated>2012-05-27T00:00:00+00:00</updated>
    <id>http://marvelley.com/2012/05/27/resources-for-learning-symfony2</id>
    <content type="html"><![CDATA[<p>I&#8217;ve been asked a few times what the best resources are for learning Symfony2. With the project still relatively young there aren&#8217;t yet (to my knowledge, anyway!) any books (physical or otherwise) on Symfony2 available, but there is a good amount of information in the form of manuals and tutorials on the web to get on with.</p>

<p><a href="http://stackoverflow.com/questions/8623962/looking-for-symfony2-book">This question on Stack Overflow</a> lists most of them; specifically:</p>

<ul>
<li><a href="http://symfony.com/doc/current/book/index.html">The Book</a>: The official documentation, also available as a PDF download from the same location. The best place to start, and covers most of Symfony&#8217;s functionality, but doesn&#8217;t have many &#8216;real-world&#8217; examples, as opposed to&#8230;</li>
<li>&#8230; <a href="http://symfony.com/doc/current/cookbook/index.html">The Cookbook</a>: Complements The Book by providing some more complicated examples of how Symfony2 can be used &#8211; sometimes the example you&#8217;re desperately searching for doesn&#8217;t feature, but on the whole it&#8217;s necessary reading to understand what Symfony2&#8242;s capable of and the best ways to use it.</li>
<li>It&#8217;s not strictly a Symfony2 resource, but Fabien Potencier&#8217;s <a href="http://fabien.potencier.org/article/50/create-your-own-framework-on-top-of-the-symfony2-components-part-1">&#8216;Build your own framework&#8217;</a> series of articles use the same components that make up Symfony2 to construct a similar framework, and as such are a really good way to familiarise oneself with the building blocks often become invaluable when trying to accomplish anything complex with Symfony2.</li>
</ul>


<p>That&#8217;s it in terms of &#8216;official&#8217; resources. There are some really good community efforts too, including:</p>

<ul>
<li>A <a href="http://knpuniversity.com/">series of screencasts</a> at KnpUniversity which introduce the key features of Symfony2, from installation and configuration through to security, forms, and using Doctrine to work with data sources. These cost $$$, and I haven&#8217;t tried them myself, but KnpLabs have been very involved with the development of Symfony2 so they&#8217;re probably well worth a look.</li>
<li>The <a href="http://tutorial.symblog.co.uk/">Symblog</a> tutorial is an excellent step-by-step guide to building a blog in Symfony2, covering most of the essential topics, in the spirit of the Jobeet tutorial from the original Symfony framework. Each part of the tutorial points to related articles in the official documentation, so it&#8217;s a nice way to work through that while building something tangible.</li>
<li>Speaking of the Jobeet tutorial, there&#8217;s also <a href="http://www.ens.ro/2012/03/21/jobeet-tutorial-with-symfony2/">a companion tutorial</a> for Symfony2. Like the Symblog tutorial, this explains the MVC approach to development with Symfony2 and dips into functional/unit testing too.</li>
<li>I&#8217;ve found the <a href="http://php-and-symfony.matthiasnoback.nl/">PHP and Symfony</a> blog to be one of the best for learning about less common features of the framework, the sort of topics that are crucial when going beyond building the simple blog apps.</li>
<li><a href="http://richardmiller.co.uk/">Richard Miller</a>&#8216;s blog is also excellent for the same reason.</li>
</ul>


<p>Each of those resources will probably give anyone with decent PHP experience enough information to start building applications with the framework. Questions will inevitably arise, in which case go to the following places for help:</p>

<ul>
<li><a href="https://groups.google.com/forum/?fromgroups#!forum/symfony2">The Symfony2 Google Group</a> is handy because often the problem you have has been answered already, so it&#8217;s a good resource as well as somewhere to get help from others using the framework.</li>
<li><a href="http://symfony.com/irc">The Symfony2 IRC Channel</a> is good for real-time assistance, and is populated with both experts and newbies. Following the chat is a great way to pick up hints and tips for problems you have yet to encounter.</li>
</ul>


<p>If there are other good resources that I&#8217;ve missed, please let me know and I&#8217;ll add them. I&#8217;ll try to keep this article up to date in future as new resources emerge.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Building Web Apps Like a (England) Boss.]]></title>
    <link href="http://marvelley.com/2012/05/16/building-web-apps-like-a-england-boss/"/>
    <updated>2012-05-16T00:00:00+00:00</updated>
    <id>http://marvelley.com/2012/05/16/building-web-apps-like-a-england-boss</id>
    <content type="html"><![CDATA[<p>If you think app development and football have nothing in common, read on.</p>

<p>There was a discussion on our IRC server at work this morning which centred on how to best mitigate the risk involved with using third party tools in web applications. Not just at the code level, as in a JavaScript library like <a href="http://jquery.com/">jQuery</a>, or a PHP framework like <a href="http://symfony.com/">Symfony2</a>, but right through the stack &#8211; from the OS, to the web server, to the app codebase and beyond.</p>

<p>Much of the discussion was along the lines of what you&#8217;d expect when devops (or sysadmins) and developers collide &#8211; those responsible for managing the stack want things that can be easily automated, are verifiable (ideally through something like checksums) and reliable (i.e. not placed directly on a production server from a Pentium 3 machine in some teenager&#8217;s bedroom half way round the world), while those responsible for writing the code want to be able to use the best tool for the job, whether it be a tried and trusted web server or the newest, shiniest Symfony2 bundle.</p>

<p>The general consensus was that both have equal importance. Personally, I think that depending on the nature of the app, it&#8217;s wise to proportion risk accordingly; an app with a USP centred around some novel, interactive UX may want to incorporate a new innovative JavaScript toolkit even if it&#8217;s yet to reach version 1.0, whereas an app with paramount speed and scalability requirements might want to try <a href="http://blog.digitalstruct.com/2010/07/12/getting-started-with-nginx-and-php-fpm/">PHP-FPM with nginx</a> in place of a more familiar solution like mod-php with Apache.</p>

<p>In isolation, either of these decisions probably wouldn&#8217;t pose a problem. Combining many such scenarios, though, may eventually load the project with enough risk as to eventually make it untenable. The holy grail is to arrive at a point where we have an app that delivers its required functionality while making use of as many trusted, reliable tools as possible, and can be managed in such a way as to make deployment and maintenance safe and simple.</p>

<p>Now, to the title of this post. While this discussion was raging in IRC, there was much furore over the <a href="http://www.guardian.co.uk/football/2012/may/16/euro-2012-england-squad-announcement-live">selection of the provisional England squad</a> for the Euro 2012 tournament. It occurred to me that the new England manager, Roy Hodgson, is facing many of the same challenges myself and my coworkers face when trying to decide on a strategy for selecting the players he thinks will combine to great effect in a few month&#8217;s time. He wants a team that blends reliable, experienced, mature players with younger, modern ones &#8211; with maybe a sprinkling of unpredictable, yet highly creative, firebrands that can make the difference between a good squad and a great one. This is essentially what I was trying to articulate in the conversation, but swapping players for libraries, or tools, written by myself, or by others.</p>

<p>So when I was scanning the list of players that are going to Poland and the Ukraine this summer, I couldn&#8217;t help but think of them in a technical fashion. For example:</p>

<ul>
<li>John Terry (Defender) &#8211; Very experienced, but can be unreliable and prone to catastrophic behaviour. (Windows OS &#8211; ever tried hosting a PHP app on Windows?).</li>
<li>Alex Oxlade-Chamberlain (Midfielder) &#8211; New kid on the block, has a speciality that offers a new dimension (see: nginx and content distribution networks)</li>
<li>Stuart Downing (Midfielder) &#8211; Does what he does and does it well enough, but isn&#8217;t going to make a massive difference overall. Comes with baggage and divides opinion. (CodeIgniter/CakePHP/any other technically limited PHP framework)</li>
<li>Wayne Rooney &#8211; Best of breed, unrivalled, links up with others very well, difficult to replicate or replace (jQuery)</li>
</ul>


<p>It&#8217;s a popular argument at the moment that more people should be aware of, and be able to, code. But perhaps we&#8217;re missing a trick &#8211; perhaps a few games of <a href="http://www.footballmanager.com/">Football Manager</a> is all it takes to be able to understand how to compose a fabulous web app these days.</p>
]]></content>
  </entry>
  
</feed>
